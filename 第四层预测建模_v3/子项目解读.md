# 第四层预测建模_v3｜时间序列预测（数据扩展 + Prophet/SARIMAX/Holt-Winters）子项目解读

> 说明：本文中出现的相对路径，默认以项目根目录 `E:\PycharmProjects\三创赛` 为基准。

## 1. 子项目定位（在全链路中的作用）

在 Amazon 场景下，真实销量往往不可得或不完整；本层通过“**模拟生成符合电商规律的时间序列数据**”来支撑时间序列建模与业务预测展示，并给出：

- 市场热度（评论量）预测：Prophet
- 类目销量季节性与事件影响：SARIMAX（含外生变量）
- 单品补货/短期销量预测：Holt-Winters（对 Top ASIN）

输出的图与报告主要用于比赛答辩中“**趋势判断 + 备货/营销建议**”部分。

---

## 2. 本层使用的数据（输入与生成逻辑）

### 2.1 模拟数据生成（核心）

脚本：`generate_realistic_ecommerce_data.py`

核心假设（脚本已参数化）：

- 时间范围：2023-01 至 2025-12（36 个月）
- 长期趋势：年增长率（默认 15%）
- 季节性：Q4、Prime Day、Black Friday、1 月回落等乘数
- 噪声：评论/销量/单品层噪声
- 产品生命周期：S 型爬坡 → 成熟 → 衰退（用于 ASIN 级序列）

生成的文件（也在 `EXTENDED_DATA_README.md` 中有说明）：

- `prophet_extended_reviews_monthly.csv`（Prophet 输入：`ds,y`）
- `sim_sales_monthly_category_extended.csv`（SARIMAX 输入：类目月销量+评论）
- `sim_sales_monthly_by_asin_extended.csv`（ASIN 月销量面板：约 348 个 ASIN × 36 月）
- 校验图：`extended_data_validation.png`

> 项目书写法：明确写成“基于真实电商规律的模拟数据集”，并在“局限性”里说明与真实销量的差异。

### 2.2 预测建模（使用上述输入）

脚本：`time_series_forecasting_complete.py`

读取：

- `prophet_extended_reviews_monthly.csv`
- `sim_sales_monthly_category_extended.csv`
- `sim_sales_monthly_by_asin_extended.csv`
- （可选）`reviews_cleaned.csv`（用于额外统计/对齐）

---

## 3. 核心方法与技术点（比赛可写的“建模亮点”）

- **Prophet（评论量预测）**
  - 优点：趋势+季节性可解释、自动变点、适合业务汇报

- **SARIMAX（类目销量季节性/事件影响）**
  - 优点：可估计外生变量系数（例如 Q4、Prime Day），并给出显著性（p 值）
  - 项目书要点：强调“方向性洞察 + 统计解释”，并说明样本量不足时显著性会下降

- **Holt-Winters（单品预测）**
  - 优点：小样本稳定、对多 ASIN 快速训练、适合短期备货
  - 项目书要点：强调“只建议用短期（1-2 个月）预测做库存决策”

---

## 4. 输出产物清单（数据 + 图像 + 报告）

### 4.1 预测结果输出目录：`forecasting_results/`

- 报告：`forecasting_results/FORECASTING_REPORT.md`
  - 已包含：三模型用途、指标（MAE/RMSE/MAPE）、未来 6 个月预测表、业务建议与局限性

- 预测数据：
  - `forecasting_results/data/prophet_forecast.csv`（yhat + 置信区间 + 分解项）
  - `forecasting_results/data/sarimax_forecast.csv`（forecast + CI）

- 图像（项目书/PPT 主图）：
  - `01_data_overview.png`：三类输入序列概览（评论、类目销量、Top ASIN）
  - `02_prophet_reviews_forecast.png`：Prophet 评论量预测（含趋势/季节性分解）
  - `03_sarimax_seasonality_analysis.png`：SARIMAX 季节性与系数解释
  - `04_holt_winters_asin_forecast.png`：Top ASIN Holt-Winters 预测曲线
  - `05_holt_winters_comparison.png`：多 ASIN 对比（MAPE/表现）
  - `06_business_dashboard.png`：业务决策看板（汇总关键指标）

### 4.2 数据生成侧产物（用于“数据可信性”展示）

- `EXTENDED_DATA_README.md`：模拟数据集说明（季节性、增长率、范围）
- `extended_data_validation.png`：生成数据的合理性校验图（趋势/季节性/区间）

---

## 5. 图像解读与项目书写法（逐图给“可直接用”的话术）

### 5.1 `extended_data_validation.png`（数据生成校验）

写法模板：

> “图X 为模拟数据质量校验结果：序列在 2023-2025 呈现稳定增长趋势，并在 Q4、Prime Day 等节点出现符合电商规律的季节性峰值，说明该模拟数据可用于趋势预测与方法展示。”

### 5.2 `01_data_overview.png`（输入序列概览）

写法模板：

> “图X 汇总了三类时间序列：评论量（热度先行指标）、类目销量（需求规模）、Top ASIN 销量（单品层波动）。为后续分别建模提供依据。”

### 5.3 `02_prophet_reviews_forecast.png`（Prophet 评论量预测）

写法模板：

> “图X 展示了 Prophet 对未来评论量的预测及置信区间。评论量可视作类目热度/社媒声量代理指标，可用于规划营销节奏与口碑运营资源。”

### 5.4 `03_sarimax_seasonality_analysis.png`（SARIMAX 季节性）

写法模板（务必提“显著性/样本量”）：

> “图X 通过 SARIMAX 估计 Q4、Prime Day 等事件对类目销量的影响方向；受样本期（约 33 个月）限制，部分系数未达统计显著，但方向性结论仍可为备货与活动排期提供参考，建议后续补充更长周期数据提升显著性。”

### 5.5 `04_holt_winters_asin_forecast.png` & `05_holt_winters_comparison.png`

写法模板：

> “图X 给出 Top ASIN 的 Holt-Winters 预测曲线与误差指标（MAPE）。由于单品层不确定性更强，建议仅使用未来 1-2 个月预测支持补货决策，长期仅作趋势参考。”

### 5.6 `06_business_dashboard.png`（业务看板）

写法模板：

> “图X 将三类预测结果聚合为管理层看板：类目热度趋势、类目销量区间、Top 单品预测与误差提示，形成可执行的备货/营销建议。”

---

## 6. 复现运行方式（建议按两步跑）

在 `第四层预测建模_v3/` 下：

```bash
pip install -r requirements.txt

# 1) 生成扩展模拟数据
python generate_realistic_ecommerce_data.py

# 2) 训练并输出时间序列预测结果（图 + 报告 + 预测CSV）
python time_series_forecasting_complete.py
```

---

## 7. 注意事项（比赛写“局限性/合规性”很加分）

- 本层销量序列为模拟生成，不代表真实销量；项目书需明确“用于方法展示与决策框架验证”。
- SARIMAX 的显著性依赖样本量与数据质量；报告中已提示“解释方向，不解释幅度”。
- Holt-Winters 预测置信区间随预测期拉长会显著变宽，项目书可强调“短期备货”应用场景。
